"use strict";

var _interopRequireDefault = require("@babel/runtime-corejs2/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.castGeojson = castGeojson;

var _tv = _interopRequireDefault(require("tv4"));

var _lodash = _interopRequireDefault(require("lodash"));

var _error = require("./error");

var _geojson = _interopRequireDefault(require("../../profiles/geojson.json"));

// Module API
function castGeojson(format, value) {
  if (!_lodash.default.isObject(value)) {
    if (!_lodash.default.isString(value)) {
      return _error.ERROR;
    }

    try {
      value = JSON.parse(value);
    } catch (error) {
      return _error.ERROR;
    }
  }

  if (format === "default") {
    try {
      var valid = _tv.default.validate(value, _geojson.default);

      if (!valid) {
        return _error.ERROR;
      }
    } catch (error) {
      return _error.ERROR;
    }
  } else if (format === "topojson") {
    if (!_lodash.default.isPlainObject(value)) {
      return _error.ERROR;
    }
  }

  return value;
}